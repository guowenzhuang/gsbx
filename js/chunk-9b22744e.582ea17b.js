(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9b22744e"],{2416:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"personal"},[a("div",{staticStyle:{"border-bottom":"1px solid #cccccc","font-size":"18px"}},[e._v("个人信息")]),a("div",{staticClass:"userinfo"},[a("a-row",{staticClass:"user-head",attrs:{type:"flex",justify:"center",gutter:20}},[a("a-col",{attrs:{span:6}},[a("a-upload-dragger",{staticClass:"avatar-uploader",attrs:{name:"avatar",listType:"picture-card",showUploadList:!1,action:"https://sm.ms/api/upload",beforeUpload:e.beforeUpload,accept:"image/*"},on:{change:e.handleChange}},[null!=e.user.headUrl?a("div",{staticClass:"user-box"},[a("img",{attrs:{src:e.user.headUrl,alt:"avatar"}}),a("a-button",{staticStyle:{"margin-top":"5px"}},[e._v("上传文件")])],1):a("div",[a("a-icon",{attrs:{type:e.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1)])],1)],1),a("a-row",{staticClass:"user-name",staticStyle:{"margin-top":"8.8vh"},attrs:{align:"middle",type:"flex",justify:"center",gutter:20}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:2}},[e._v("用户名:")]),a("a-col",{attrs:{span:6}},[a("a-input",{ref:"userNameInput",attrs:{placeholder:"Basic usage"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}},[a("a-icon",{attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1)],1),a("div",{staticStyle:{display:"flex","justify-content":"center","margin-top":"3vh"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.updateUser}},[e._v("确定修改")])],1)],1)])},n=[],r=(a("7f7f"),a("2423")),i=a("c24f"),c=a("e819"),o={name:"Personal",data:function(){return{user:{},loading:!1,issue:{}}},methods:{updateUser:function(){var e=this;Object(r["d"])({articleId:this.issue.number,body:JSON.stringify(this.user),labels:[c["a"].userInfoLabel]}).then(function(t){e.$message.success("用户信息修改成功"),e.$store.commit("setName",e.user.name)})},handleChange:function(e){var t=this,a=new FormData;a.append("smfile",e.file),this.$setLoading(!0),Object(i["d"])(a).then(function(e){t.$setLoading(!1),e.json().then(function(e){e.success?(t.user.headUrl=e.data.url,null!=t.user.hash&&Object(i["c"])(t.user.hash),t.user.hash=e.data.hash,Object(r["d"])({articleId:t.issue.number,body:JSON.stringify(t.user),labels:[c["a"].userInfoLabel]}).then(function(e){t.$message.success("头像上传成功"),t.$store.commit("setHead",t.user.headUrl)})):t.$message.error("头像上传失败,message: "+e.message)})})},acceptUpload:function(e){var t="image/jpeg"===e.type;t||this.$message.error("You can only upload JPG file!");var a=e.size/1024/1024<2;return a||this.$message.error("Image must smaller than 2MB!"),t&&a},beforeUpload:function(){return!1}},created:function(){var e=this;Object(r["b"])({state:"open",labels:c["a"].userInfoLabel}).then(function(t){e.user=JSON.parse(t[0].body),e.issue=t[0]})}},u=o,l=(a("2651"),a("2877")),d=Object(l["a"])(u,s,n,!1,null,null,null),p=d.exports;t["default"]=p},2423:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"d",function(){return c}),a.d(t,"b",function(){return o}),a.d(t,"c",function(){return u});var s=a("365c"),n=a("9bd2"),r=n["a"].axios;function i(e){return r({url:s["a"].addIssue,method:"post",data:e})}function c(e){return r({url:s["a"].updateIssue+e.articleId,method:"patch",data:e})}function o(e){return r({url:s["a"].getIssue,method:"get",params:e})}function u(e){return r({url:s["a"].getIssueDetail+e,method:"get"})}},2651:function(e,t,a){"use strict";var s=a("54be"),n=a.n(s);n.a},"365c":function(e,t,a){"use strict";var s=a("e819"),n={getCode:"https://github.com/login/oauth/authorize?client_id=".concat(s["a"].clientId,"&scope=public_repo"),getToken:"https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token",getActiveUser:"https://api.github.com/user",addIssue:"https://api.github.com/repos/".concat(s["a"].username,"/").concat(s["a"].articleRepo,"/issues"),updateIssue:"https://api.github.com/repos/".concat(s["a"].username,"/").concat(s["a"].articleRepo,"/issues/"),getIssue:"https://api.github.com/repos/".concat(s["a"].username,"/").concat(s["a"].articleRepo,"/issues"),getIssueDetail:"https://api.github.com/repos/".concat(s["a"].username,"/").concat(s["a"].articleRepo,"/issues/"),imgUpload:"https://sm.ms/api/v2/upload",imgDelete:"https://sm.ms/api/v2/delete/"};t["a"]=n},"54be":function(e,t,a){},"7f7f":function(e,t,a){var s=a("86cc").f,n=Function.prototype,r=/^\s*function ([^ (]*)/,i="name";i in n||a("9e1e")&&s(n,i,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(e){return""}}})},c24f:function(e,t,a){"use strict";a.d(t,"b",function(){return i}),a.d(t,"a",function(){return c}),a.d(t,"d",function(){return o}),a.d(t,"c",function(){return u});var s=a("365c"),n=a("9bd2"),r=n["a"].axios;function i(e){return r({url:s["a"].getToken,method:"post",data:e})}function c(e){return r({url:s["a"].getActiveUser,method:"get",params:e})}function o(e){return fetch(s["a"].imgUpload,{method:"POST",body:e})}function u(e){return fetch(s["a"].imgDelete+e,{method:"GET"})}},e819:function(e,t,a){"use strict";var s="production";t["a"]={clientId:"production"===s?"d318e11d5b12bf0417b6":"d7b3acf20efed15aaf3e",clientSecret:"production"===s?"35d61b835b940179de4d8dc1d3b9541ed4cd55f9":"3218bbf0edd44432d0b9605237c694d1662a74f0",username:"guowenzhuang",articleRepo:"gsbxComment",articleLabel:"article",articleMarkdownLabel:"article-md",userInfoLabel:"userinfo",adminMenu:[{title:"dashboard",key:"dashboard",icon:"pie-chart",children:[{title:"工作台",key:"workbench",icon:"reconciliation"},{title:"个人信息",key:"personal",icon:"user"}]},{title:"文章管理",key:"article",icon:"book",children:[{title:"写文章",key:"writeArticle",icon:"plus-square"},{title:"修改文章",key:"articleUpdate",icon:"file-text"}]}]}}}]);